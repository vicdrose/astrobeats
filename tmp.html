<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AstroBeats Journal</title>
<style>
  body { font-family: sans-serif; margin: 20px; }
  input, textarea { display: block; margin-bottom: 10px; width: 300px; }
  button { margin-right: 5px; }
  .entry { border: 1px solid #ccc; padding: 10px; margin-bottom: 10px; width: 320px; }
  .entry h3 { margin: 0; }
</style>
</head>
<body>

<h1>AstroBeats Journal</h1>

<div>
  <input type="text" id="title" placeholder="Title">
  <textarea id="notes" placeholder="Notes"></textarea>
  <button id="saveBtn">Save Entry</button>
  <button id="clearAllBtn">Clear All</button>
</div>

<hr>

<div id="journalList"></div>

<script>
  // --- Initialize ---
  let journalEntries = JSON.parse(localStorage.getItem("journalEntries")) || [];
  let editingId = null;

  const titleInput = document.getElementById("title");
  const notesInput = document.getElementById("notes");
  const saveBtn = document.getElementById("saveBtn");
  const clearAllBtn = document.getElementById("clearAllBtn");
  const journalList = document.getElementById("journalList");

  // --- Render entries ---
  function renderEntries() {
    journalList.innerHTML = "";
    journalEntries.forEach(entry => {
      const div = document.createElement("div");
      div.className = "entry";

      const h3 = document.createElement("h3");
      h3.textContent = entry.title;
      div.appendChild(h3);

      const p = document.createElement("p");
      p.textContent = entry.notes;
      div.appendChild(p);

      // --- Edit Button ---
      const editBtn = document.createElement("button");
      editBtn.textContent = "Edit";
      editBtn.onclick = () => startEdit(entry.id);
      div.appendChild(editBtn);

      // --- Delete Button ---
      const deleteBtn = document.createElement("button");
      deleteBtn.textContent = "Delete";
      deleteBtn.onclick = () => deleteEntry(entry.id);
      div.appendChild(deleteBtn);

      journalList.appendChild(div);
    });
  }

  // --- Save or update entry ---
  saveBtn.onclick = function() {
    const title = titleInput.value.trim();
    const notes = notesInput.value.trim();
    if (!title) return alert("Title is required");

    if (editingId !== null) {
      const index = journalEntries.findIndex(e => e.id === editingId);
      journalEntries[index] = { ...journalEntries[index], title, notes };
      editingId = null;
      saveBtn.textContent = "Save Entry";
    } else {
      const id = Date.now();
      journalEntries.push({ id, title, notes });
    }

    titleInput.value = "";
    notesInput.value = "";
    saveJournal();
    renderEntries();
  };

  // --- Start editing ---
  function startEdit(id) {
    const entry = journalEntries.find(e => e.id === id);
    titleInput.value = entry.title;
    notesInput.value = entry.notes;
    editingId = id;
    saveBtn.textContent = "Update Entry";
  }

  // --- Delete entry ---
  function deleteEntry(id) {
    if (!confirm("Delete this entry?")) return;
    journalEntries = journalEntries.filter(e => e.id !== id);
    saveJournal();
    renderEntries();
  }

  // --- Clear all entries with confirmation ---
  clearAllBtn.onclick = function() {
    const confirmed = confirm("WARNING: You are about to clear all entries. Are you sure?");
    if (!confirmed) return;
    journalEntries = [];
    saveJournal();
    renderEntries();
  };

  // --- Persist to localStorage ---
  function saveJournal() {
    localStorage.setItem("journalEntries", JSON.stringify(journalEntries));
  }

  // --- Initial render ---
  renderEntries();
</script>

</body>
</html>
